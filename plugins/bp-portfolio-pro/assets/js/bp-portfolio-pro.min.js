jQuery(document).ready(function(){function e(e,t,i,a){"undefined"==typeof a&&(a="photo"),jQuery(e).click(function(e){var t=jQuery(this).attr("id");jQuery.magnificPopup.open({items:{src:'<div class="white-popup upload-media" style="height: 450px;"><iframe id="'+t+'_frame" class="photo-dialog" src="'+ajaxurl+"?action=upload_bpcp_photos_dialog&caption="+i+"&type="+a+'" width="100%" /></div>',type:"inline"}})}),jQuery(e).click(function(){window.bpcp_media_uploader_callback=t})}function t(e){e=e.substr(0,e.length-1),e=e.split("[[SPLIT]]"),"-1"!==e[0]?jQuery(".widget ul#projects-list").fadeOut(200,function(){jQuery(".widget ul#projects-list").html(e[1]),jQuery(".widget ul#projects-list").fadeIn(200)}):jQuery(".widget ul#projects-list").fadeOut(200,function(){var t="<p>"+e[1]+"</p>";jQuery(".widget ul#projects-list").html(t),jQuery(".widget ul#projects-list").fadeIn(200)})}function i(e){e=e.substr(0,e.length-1),e=e.split("[[SPLIT]]"),"-1"!==e[0]?jQuery(".widget ul#collections-list").fadeOut(200,function(){jQuery(".widget ul#collections-list").html(e[1]),jQuery(".widget ul#collections-list").fadeIn(200)}):jQuery(".widget ul#collections-list").fadeOut(200,function(){var t="<p>"+e[1]+"</p>";jQuery(".widget ul#collections-list").html(t),jQuery(".widget ul#collections-list").fadeIn(200)})}function a(e,t){return jQuery(e).removeClass("error"),""==jQuery(e).val()||null==jQuery(e).val()?(jQuery(e).addClass("error"),jQuery(e).after('<small class="error">'+t+"</small>"),!1):!0}window.bpcp_photo_dialog_callback=function(e){jQuery.magnificPopup.close(),window.bpcp_media_uploader_callback(e)},jQuery(".bpcp_project_photo").magnificPopup({delegate:"a",type:"image",tLoading:"Loading image #%curr%...",mainClass:"mfp-img-mobile",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">The image #%curr%</a> could not be loaded.',titleSrc:function(e){return e.el.attr("title")}}}),jQuery(".bpcp_pro_wip_single_thumb img").click(function(){var e=$(this).data("src");$.magnificPopup.open({items:{src:e},type:"image"})}),jQuery(".bpcp-modal").magnificPopup({type:"inline",preloader:!1,callbacks:{open:function(){jQuery(".video_error_message").length&&jQuery(".video_error_message").html("")}}}),jQuery(document).on("click",".bpcp-modal-cancel",function(e){e.preventDefault(),jQuery.magnificPopup.close()}),jQuery(".bpcp-pro-tab-title-filter #projects-order-by").live("change",function(){var e=jQuery(this),t=e.val(),i={action:"bpcpproajax",task:"projects_order_filtering",projects_filter_by:t};return jQuery.post(ajaxurl,i,function(e){jQuery(".bb-display-projects .bb-project-items").html(e)}),!1}),jQuery("select.auto_submit_pform").live("change",function(){jQuery(this).closest("form").submit()}),jQuery(".revision-thumbs li").on("click",function(){var e=jQuery(this),t=jQuery(this).find("a").attr("data-revid"),i=(jQuery(this).find("a").attr("data-postid"),{action:"bpcpproajax",task:"revision_switch",revision_id:t});return jQuery(".bpcp_pro_wip_single_thumb p").addClass("loading").append('<span class="loader-overlay"><span class="throbber-loader"></span></span>'),jQuery.post(ajaxurl,i,function(t){var t=jQuery.parseJSON(t);e.parent().find("li").removeClass("active"),e.addClass("active"),jQuery(".bpcp_pro_wip_single_thumb img").attr("src",t.thumb_url),jQuery(".bpcp_pro_wip_single_thumb p").removeClass("loading"),jQuery(".wip-views-count span").html(t.wip_views),jQuery(".loader-overlay").remove(),jQuery("#comments").after('<div id="comments-placeholder"></div>'),jQuery("#comments").remove();var i=jQuery(t.comments);i.find("#reply-title").html(bpcp_object.wip_comment_heading),jQuery("#comments-placeholder").html(i),jQuery("#comments-placeholder").attr("id","comments")}),!1}),jQuery(".bpcp-components-like #like_this_post").live("click",function(){var e=jQuery(this),t=e.attr("data-userid"),i=e.attr("data-postid"),a=e.attr("data-posttype"),o={action:"bpcpproajax",task:"bpcp_components_like",postid:i,userid:t,post_type:a};return jQuery.post(ajaxurl,o,function(t){var t=jQuery.parseJSON(t);if(""!=t.status&&"success"==t.status){e.html("<b>"+bpcp_object.appreciated_text+"</b>"),e.attr("id","unlike_this_post");var i=parseInt(jQuery(".bpcp-components-like .appreciation_count span").html());jQuery(".bpcp-components-like .appreciation_count span").html(i+1)}}),!1}),jQuery(".bpcp-components-like #unlike_this_post").live("click",function(){var e=jQuery(this),t=e.attr("data-userid"),i=e.attr("data-postid"),a=e.attr("data-posttype"),o={action:"bpcpproajax",task:"bpcp_components_unlike",postid:i,userid:t,post_type:a};return jQuery.post(ajaxurl,o,function(t){var t=jQuery.parseJSON(t);if(""!=t.status&&"success"==t.status){e.html("<b>"+bpcp_object.appreciate_this_text+"</b>"),e.attr("id","like_this_post");var i=parseInt(jQuery(".bpcp-components-like .appreciation_count span").html());jQuery(".bpcp-components-like .appreciation_count span").html(i-1)}}),!1});var o=jQuery(".bpcp_collections_list :input");"0"==jQuery(o).length&&jQuery(".bpcp-right").hide(),jQuery(".add-collection-details .project-single-btn #collection_add").on("click",function(){var e=jQuery(this);e.attr("disabled",!0);var t=e.parent().parent().find("#collection_description"),i=t.val(),a=e.parent().parent().find("#collection_title"),o=a.val(),r=e.parent().parent().find("#collection_visibility").val(),c={action:"bpcpproajax",task:"collection_add",collection_description:i,collection_title:o,collection_visibility:r};return jQuery.post(ajaxurl,c,function(t){e.parent().append(t),setTimeout(function(){e.attr("disabled",!1),location.reload()},3e3)}),!1}),jQuery(".add-collection-details #collection_save").on("click",function(){var e=jQuery(this);e.attr("disabled",!0);var t=e.parent().find("#current_project_id").val(),i=e.parent().parent().find(".bpcp_collections_list input[type=checkbox]:checked").map(function(){return this.value}).get().join(","),a=e.parent().parent().find(".bpcp_collections_list input[type=checkbox]").not(":checked").map(function(){return this.value}).get().join(","),o={action:"bpcpproajax",task:"add_project_as_collection_item",current_project_id:t,chosen_collection:i,not_chosen_collection:a};jQuery.post(ajaxurl,o,function(t){e.after(t),setTimeout(function(){e.attr("disabled",!1),location.reload()},3e3)})}),jQuery(".add-video-details #video_add").on("click",function(){var e=jQuery(this),t=e.parent().parent().find("#current_project_id").val(),i=e.parent().parent().find("#video_embed_url"),a=i.val();if(""==a)return jQuery(".video_error_message").html(bpcp_object.video_embed_empty_msg),!1;var o={action:"bpcpproajax",task:"embed_video_url_to_project",current_project_id:t,video_embed_url:a};jQuery.post(ajaxurl,o,function(e){var e=jQuery.parseJSON(e);if(""!=e.video_id&&""!=e.video_output){var t='<ul id="'+e.video_id+'" class="bpcp-li-left"><li class="project_item">'+e.video_output+"</li>";t+='<li><input type="hidden" name="embeded_url" value="'+a+'" /><label for="attachment_caption">'+bpcp_object.caption_input_label+'</label><input type="hidden" name="video_item[vid][]" value="'+e.video_id+'" /><input type="text" name="video_item[vcaption][]" class="attachment-caption" value="" /><a href="#" class="delete-video">'+bpcp_object.delete_btn+"</a></li></ul>",jQuery(".uploaded-images").append(t),jQuery(".bpcp-buttons .bpcp-media-upload-title").html(bpcp_object.upload_another_image),jQuery("video,audio").mediaelementplayer(),jQuery.magnificPopup.close(),i.val(""),r(),c()}else jQuery(".video_error_message").html(bpcp_object.video_embed_disable_msg)})}),jQuery("a.delete-video").live("click",function(e){e.preventDefault();var t=jQuery(this),i=t.parent().find('input[name="embeded_url"]').val(),a=t.parent().parent().attr("id"),o=jQuery(".add-video-details #current_project_id").val(),r={action:"bpcpproajax",task:"remove_embeded_video_url_from_project",current_project_id:o,video_embed_url:i,video_ID:a};jQuery.post(ajaxurl,r,function(e){c()}),t.parent().parent().hide(0,function(){jQuery(this).remove(),0==jQuery(".uploaded-images").find("ul").length&&jQuery(".bpcp-media-upload-title").html(bpcp_object.image_upload_text)})}),jQuery(".uploaded-images .caption-save").live("click",function(){var e=jQuery(this),t=e.parent().find('input[name="atachment_id"]').val(),i=e.parent().find('input[name="attachment_caption"]').val(),a={action:"bpcpproajax",task:"set_project_attachment_caption",attachment_ID:t,caption_value:i};jQuery.post(ajaxurl,a,function(e){var e=jQuery.parseJSON(e);jQuery.magnificPopup.open({items:{src:'<div class="bbcp-white-popup-block"><h4>'+e.message+"</h4></div>",type:"inline"}})})}),jQuery(".uploaded-images .video-caption-save").live("click",function(){var e=jQuery(this),t=jQuery(".add-video-details #current_project_id").val(),i=e.parent().parent().attr("id"),a=e.parent().find('input[name="attachment_caption"]').val(),o={action:"bpcpproajax",task:"set_project_video_attachment_caption",current_project_id:t,video_ID:i,caption_value:a};jQuery.post(ajaxurl,o,function(e){var e=jQuery.parseJSON(e);jQuery.magnificPopup.open({items:{src:'<div class="bbcp-white-popup-block"><h4>'+e.message+"</h4></div>",type:"inline"}})})});var r=function(){jQuery(".uploaded-images").sortable({items:"ul",axis:"y",update:function(e,t){var i=jQuery(this).sortable("serialize"),a=jQuery(".add-video-details #current_project_id").val(),o={action:"bpcpproajax",task:"project_items_sorting",current_project_id:a,sort_data:i};jQuery.post(ajaxurl,o,function(e){})}})};r();var c=function(){var e=jQuery(".uploaded-images").sortable("serialize"),t=jQuery(".add-video-details #current_project_id").val(),i={action:"bpcpproajax",task:"project_items_sorting",current_project_id:t,sort_data:e};jQuery.post(ajaxurl,i,function(e){})};jQuery(".add-project-details #create_project").on("click",function(){jQuery(".add-project-details").find("small.error").remove();var e=a(".add-project-details #project_title",bpcp_object.project_title_missing),t=!0;return bpcp_object.project_category_required&&jQuery(".bp-category-multiselect").length&&(t=a(".add-project-details #project-category",bpcp_object.project_category_missing)),e===!1||t===!1?!1:!0}),jQuery(".add-project-details #project_finish").on("click",function(){jQuery(".add-project-details").find("small.error").remove();var e=a(".add-project-details #project_visibility",bpcp_object.project_visibility_missing);return e===!1?!1:!0}),jQuery(".add-wip-details #wip_finish").on("click",function(){jQuery(".add-wip-details").find("small.error").remove();var e=a(".add-wip-details #wip_title",bpcp_object.wip_title_missing),t=!0,i=jQuery(this).parents().find(".bbp-is-revision");return bpcp_object.wip_category_required&&jQuery(".bp-category-multiselect").length&&(t=a(".add-wip-details #wip-category",bpcp_object.wip_category_missing)),e!==!1&&t!==!1||i.length>0?!0:!1}),jQuery(".add-collection-details #collection_add").on("click",function(){jQuery(".add-collection-details").find("small.error").remove();var e=a(".add-collection-details #collection_title",bpcp_object.collection_title_missing);return e===!1?!1:!0}),e(jQuery("#upload_image"),function(e){var t='<ul id="attach-'+e.id+'" class="bpcp-li-left"><li class="project_item">';t+='<img class="display-image" src="'+e.large[0]+'"/></li>',t+='<li><input class="chosen_file" type="hidden" name="chosen_file[]" value="'+e.id+'" /><input type="hidden" name="atachment_id" value="'+e.id+'" /><label for="attachment_caption">'+bpcp_object.caption_input_label+'</label><input type="hidden" name="photo_item[pid][]" value="'+e.id+'" /><input type="text" name="photo_item[pcaption][]" class="attachment-caption" value="'+e.caption+'" /><a href="#" class="delete-image">'+bpcp_object.delete_btn+"</a></li></ul>",jQuery(".uploaded-images").append(t),jQuery(".uploaded-images").parent().find(".bpcp-media-upload-title").html(bpcp_object.upload_another_image)},"1"),e(jQuery("#upload_song"),function(e){var t='<ul id="attach-'+e.id+'" class="bpcp-li-left"><li class="project_item">';t+='<!--[if lt IE 9]><script>document.createElement(\'audio\');</script><![endif]--><audio class="wp-audio-shortcode" preload="none" controls="controls"><source type="audio/mpeg" src="'+e.url+'?_=1" /><a href="'+e.url+'">'+e.url+"</a></audio></li>",t+='<li><input class="chosen_file" type="hidden" name="chosen_file[]" value="'+e.id+'" /><input type="hidden" name="atachment_id" value="'+e.id+'" /><label for="attachment_caption">'+bpcp_object.caption_input_label+'</label><input type="hidden" name="photo_item[pid][]" value="'+e.id+'" /><input type="text" name="photo_item[pcaption][]" class="attachment-caption" value="'+e.caption+'" /><a href="#" class="delete-image">'+bpcp_object.delete_btn+"</a></li></ul>",jQuery(".uploaded-images").append(t),jQuery(".uploaded-images").parent().find(".bpcp-media-upload-title").html(bpcp_object.upload_another_image)},"1","song"),e(jQuery("#upload_cover"),function(e){jQuery("#display_cover_image").attr("src",e.large[0]),jQuery(".chosen-cover").val(e.id)},0),e(jQuery("#upload_wip_image"),function(e){var t='<ul class="bpcp-li-left"><li>';t+='<img class="display-image" src="'+e.large[0]+'"/></li>',t+='<li><input class="chosen_file" type="hidden" name="chosen_file" value="'+e.id+'" /><input type="hidden" name="atachment_id" value="'+e.id+'" /><a href="#" class="delete-image">'+bpcp_object.delete_btn+"</a></li></ul>",jQuery(".uploaded-images").append(t),jQuery(".bpcp-buttons #upload_wip_image").hide()},0),jQuery("a.delete-image").live("click",function(e){e.preventDefault();var t=(jQuery(".add-video-details #current_project_id").val(),jQuery(this).parent().find('input[name="atachment_id"]').val()),i={action:"bbpajax",task:"remove_project_attachment",attachment_ID:t};jQuery.post(ajaxurl,i,function(e){}),jQuery(this).parent().parent().remove(),jQuery(".bpcp-buttons #upload_wip_image").show(),0==jQuery(".uploaded-images").find("ul").length&&jQuery(".bpcp-media-upload-title").html(bpcp_object.image_upload_text),c()}),jQuery(document).ready(function(){jQuery(".widget div#projects-list-options a").on("click",function(){var e=this;return jQuery(e).addClass("loading"),jQuery(".widget div#projects-list-options a").removeClass("selected"),jQuery(this).addClass("selected"),jQuery.post(ajaxurl,{action:"widget_bpcp_pro_projects",cookie:encodeURIComponent(document.cookie),_wpnonce:jQuery("input#_wpnonce-projects").val(),"max-projects":jQuery("input#projects_widget_max").val(),filter:jQuery(this).attr("id")},function(i){jQuery(e).removeClass("loading"),t(i)}),!1})}),jQuery(document).ready(function(){jQuery(".widget div#collections-list-options a").on("click",function(){var e=this;return jQuery(e).addClass("loading"),jQuery(".widget div#collections-list-options a").removeClass("selected"),jQuery(this).addClass("selected"),jQuery.post(ajaxurl,{action:"widget_bpcp_pro_collections",cookie:encodeURIComponent(document.cookie),_wpnonce:jQuery("input#_wpnonce-collections").val(),"max-collections":jQuery("input#collections_widget_max").val(),filter:jQuery(this).attr("id")},function(t){jQuery(e).removeClass("loading"),i(t)}),!1})}),jQuery(".bp-category-multiselect").length&&jQuery(".bp-category-multiselect").chosen({placeholder_text_multiple:bpcp_object.multiselect_placeholder}),jQuery(".bp-work-filter").change(function(){window.location.href=$(this).val()})});